#! /bin/bash

generateCode() {
    echo $((RANDOM % 9000 + 1000));
}

printCompareResult(){
    local guess="$1"
    local code="$2"

    declare -i flag;

    for (( i=0; i<${#guess}; i++)) 
    do
        flag=0
        if [ ${code:$i:1} -eq ${guess:$i:1} ] 
        then
            echo -n "■ "
        else
            for (( j=0; j<${#code}; j++))
            do
                if [ ${code:$j:1} -eq ${guess:$i:1} ] 
                then
                    echo -n "◪ "
                    flag=1
                    break
                fi
            done
            if [ $flag -eq 0 ]
            then
                echo -n "□ "
            fi
        fi
    done
    
    echo
    echo
    echo "\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$\$"
    echo
}

printBanner() {
    echo "\$\$     \$\$    \$\$\$     \$\$\$\$\$\$  \$\$\$\$\$\$\$\$ \$\$\$\$\$\$\$\$ \$\$\$\$\$\$\$\$  \$\$     \$\$ \$\$\$\$ \$\$    \$\$ \$\$\$\$\$\$\$\$ "
    echo "\$\$\$   \$\$\$   \$\$ \$\$   \$\$    \$\$    \$\$    \$\$       \$\$     \$\$ \$\$\$   \$\$\$  \$\$  \$\$\$   \$\$ \$\$     \$\$"
    echo "\$\$\$\$ \$\$\$\$  \$\$   \$\$  \$\$          \$\$    \$\$       \$\$     \$\$ \$\$\$\$ \$\$\$\$  \$\$  \$\$\$\$  \$\$ \$\$     \$\$" 
    echo "\$\$ \$\$\$ \$\$ \$\$     \$\$  \$\$\$\$\$\$     \$\$    \$\$\$\$\$\$   \$\$\$\$\$\$\$\$  \$\$ \$\$\$ \$\$  \$\$  \$\$ \$\$ \$\$ \$\$     \$\$" 
    echo "\$\$     \$\$ \$\$\$\$\$\$\$\$\$       \$\$    \$\$    \$\$       \$\$   \$\$   \$\$     \$\$  \$\$  \$\$  \$\$\$\$ \$\$     \$\$"
    echo "\$\$     \$\$ \$\$     \$\$ \$\$    \$\$    \$\$    \$\$       \$\$    \$\$  \$\$     \$\$  \$\$  \$\$   \$\$\$ \$\$     \$\$"
    echo "\$\$     \$\$ \$\$     \$\$  \$\$\$\$\$\$     \$\$    \$\$\$\$\$\$\$\$ \$\$     \$\$ \$\$     \$\$ \$\$\$\$ \$\$    \$\$ \$\$\$\$\$\$\$\$ "
    echo
}

printYouWon() {    
    echo "\$\$    \$\$  \$\$\$\$\$\$\$  \$\$     \$\$    \$\$      \$\$  \$\$\$\$\$\$\$  \$\$    \$\$ \$\$\$\$" 
    echo " \$\$  \$\$  \$\$     \$\$ \$\$     \$\$    \$\$  \$\$  \$\$ \$\$     \$\$ \$\$\$   \$\$ \$\$\$\$ "
    echo "  \$\$\$\$   \$\$     \$\$ \$\$     \$\$    \$\$  \$\$  \$\$ \$\$     \$\$ \$\$\$\$  \$\$ \$\$\$\$ "
    echo "   \$\$    \$\$     \$\$ \$\$     \$\$    \$\$  \$\$  \$\$ \$\$     \$\$ \$\$ \$\$ \$\$  \$\$  "
    echo "   \$\$    \$\$     \$\$ \$\$     \$\$    \$\$  \$\$  \$\$ \$\$     \$\$ \$\$  \$\$\$\$      "
    echo "   \$\$    \$\$     \$\$ \$\$     \$\$    \$\$  \$\$  \$\$ \$\$     \$\$ \$\$   \$\$\$ \$\$\$\$" 
    echo "   \$\$     \$\$\$\$\$\$\$   \$\$\$\$\$\$\$      \$\$\$  \$\$\$   \$\$\$\$\$\$\$  \$\$    \$\$ \$\$\$\$" 
    echo
}

run() {
    printBanner
    local code=$(generateCode)
    # echo $code
   
    for round in {1..12}
    do
        echo "ROUND #$round"
        read guess
        printCompareResult "$guess" "$code"
        if [ $guess -eq $code ] 
        then
            printYouWon
            break
        fi
    done
}

run